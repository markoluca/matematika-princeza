<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ú–∞—Ç–µ–º–∞—Ç–∏—á–∫–∞ –ü—Ä–∏–Ω—Ü–µ–∑–∞ ‚Äì –ö–æ–º–ø–ª–µ—Ç–∞–Ω –¢–µ—Å—Ç</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ff69b4">

<style>
body{
font-family:Arial, sans-serif;
background:linear-gradient(#ffe6f2,#fff4cc);
margin:0;
padding:20px;
text-align:center;
}

h1{color:#d63384;}

.card{
max-width:720px;
margin:auto;
background:white;
padding:25px;
border-radius:25px;
box-shadow:0 15px 30px rgba(0,0,0,0.15);
}

button{
padding:10px 15px;
margin:5px;
border:none;
border-radius:12px;
background:#ff69b4;
color:white;
font-weight:bold;
cursor:pointer;
}

.instruction{
font-size:18px;
margin-top:15px;
font-weight:bold;
color:#444;
line-height:1.5;
}

.question{
font-size:28px;
margin:15px 0;
min-height:40px;
}

input{
font-size:24px;
padding:8px;
width:200px;
border-radius:12px;
border:3px solid #ccc;
text-align:center;
}

.feedback{
height:24px;
font-weight:bold;
}

.result-box{
margin-top:20px;
padding:15px;
background:#fff0f6;
border-radius:15px;
display:none;
text-align:left;
}

.mistake{
background:#ffe0e0;
padding:8px;
margin:6px 0;
border-radius:8px;
}
</style>
</head>

<body>

<h1>üëë –ú–∞—Ç–µ–º–∞—Ç–∏—á–∫–∞ –ü—Ä–∏–Ω—Ü–µ–∑–∞</h1>

<div class="card">

<button onclick="startTest()">–ü–æ–∫—Ä–µ–Ω–∏ —Ç–µ—Å—Ç (20 –∑–∞–¥–∞—Ç–∞–∫–∞)</button>

<div class="instruction" id="instruction"></div>
<div class="question" id="question"></div>

<input type="text" id="answer" oninput="checkAnswer()">

<div class="feedback" id="feedback"></div>

<div class="result-box" id="resultBox"></div>

</div>

<script>

let correct="";
let instructionText="";
let explanationText="";
let questionText="";

let testCount=0;
let testCorrect=0;
let mistakes=[];
const TOTAL_TEST=20;

function rand(min,max){
return Math.floor(Math.random()*(max-min+1))+min;
}

function startTest(){
testCount=0;
testCorrect=0;
mistakes=[];
document.getElementById("resultBox").style.display="none";
newTask();
}

function newTask(){

if(testCount>=TOTAL_TEST){
endTest();
return;
}

let types=["add","sub","numbers","prevnext","compare","even","odd"];
let type=types[rand(0,types.length-1)];

let q="";

if(type==="add"){
let a=rand(0,20),b=rand(0,20);
if(a+b>20) return newTask();
correct=(a+b)+"";
instructionText="–°–∞–±–µ—Ä–∏ –±—Ä–æ—ò–µ–≤–µ.";
explanationText="–ò–∑—Ä–∞—á—É–Ω–∞—ò –∑–±–∏—Ä –∏ —É–ø–∏—à–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç.";
q=`${a} + ${b} = ?`;
}

if(type==="sub"){
let a=rand(0,20),b=rand(0,20);
if(b>a)[a,b]=[b,a];
correct=(a-b)+"";
instructionText="–û–¥—É–∑–º–∏ –±—Ä–æ—ò–µ–≤–µ.";
explanationText="–ò–∑—Ä–∞—á—É–Ω–∞—ò —Ä–∞–∑–ª–∏–∫—É –∏ —É–ø–∏—à–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç.";
q=`${a} - ${b} = ?`;
}

if(type==="numbers"){
let s=rand(1,17);
correct=(s+2)+"";
instructionText="–ü–æ–ø—É–Ω–∏ –Ω–∏–∑ –±—Ä–æ—ò–µ–≤–∞.";
explanationText="–ü–æ–≥–ª–µ–¥–∞—ò —Ä–µ–¥–æ—Å–ª–µ–¥ –±—Ä–æ—ò–µ–≤–∞ –∏ —É–ø–∏—à–∏ –±—Ä–æ—ò –∫–æ—ò–∏ –Ω–µ–¥–æ—Å—Ç–∞—ò–µ.";
q=`${s}, ${s+1}, __ , ${s+3}`;
}

if(type==="prevnext"){
let n=rand(2,18);
correct=(n-1)+"";
instructionText="–ù–∞–ø–∏—à–∏ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–∏–∫ –¥–∞—Ç–æ–≥ –±—Ä–æ—ò–∞.";
explanationText="–ü—Ä–µ—Ç—Ö–æ–¥–Ω–∏–∫ —ò–µ –±—Ä–æ—ò –∫–æ—ò–∏ –¥–æ–ª–∞–∑–∏ –ø—Ä–µ –¥–∞—Ç–æ–≥ –±—Ä–æ—ò–∞.";
q=`__, ${n}, ${n+1}`;
}

if(type==="compare"){
let a=rand(0,20),b=rand(0,20);
correct=(a>b?">":a<b?"<":"=");
instructionText="–£–ø–æ—Ä–µ–¥–∏ –±—Ä–æ—ò–µ–≤–µ.";
explanationText="–£–ø–∏—à–∏ > –∞–∫–æ —ò–µ –ø—Ä–≤–∏ –±—Ä–æ—ò –≤–µ—õ–∏, < –∞–∫–æ —ò–µ –º–∞—ö–∏ –∏–ª–∏ = –∞–∫–æ —Å—É —ò–µ–¥–Ω–∞–∫–∏.";
q=`${a} ? ${b}`;
}

if(type==="even"){
instructionText="–ù–∞–ø–∏—à–∏ –ø–∞—Ä–Ω–µ –±—Ä–æ—ò–µ–≤–µ.";
explanationText="–ü–∞—Ä–Ω–∏ –±—Ä–æ—ò–µ–≤–∏ —Å—É –¥–µ—ô–∏–≤–∏ —Å–∞ 2. –£–ø–∏—à–∏ –∏—Ö —ò–µ–¥–∞–Ω –∑–∞ –¥—Ä—É–≥–∏–º.";

let variant=rand(1,2);

if(variant===1){
correct="1416";
q="–ö–æ—ò–∏ —Å—É –ø–∞—Ä–Ω–∏ –±—Ä–æ—ò–µ–≤–∏ –∏–∑–º–µ—í—É 12 –∏ 18?";
}

if(variant===2){
correct="2468";
q="–ö–æ—ò–∏ —Å—É –ø–∞—Ä–Ω–∏ –±—Ä–æ—ò–µ–≤–∏ –∏–∑–º–µ—í—É 1 –∏ 10?";
}
}

if(type==="odd"){
instructionText="–ù–∞–ø–∏—à–∏ –Ω–µ–ø–∞—Ä–Ω–µ –±—Ä–æ—ò–µ–≤–µ.";
explanationText="–ù–µ–ø–∞—Ä–Ω–∏ –±—Ä–æ—ò–µ–≤–∏ –Ω–∏—Å—É –¥–µ—ô–∏–≤–∏ —Å–∞ 2. –£–ø–∏—à–∏ –∏—Ö —ò–µ–¥–∞–Ω –∑–∞ –¥—Ä—É–≥–∏–º.";

let variant=rand(1,2);

if(variant===1){
correct="3579";
q="–ö–æ—ò–∏ —Å—É –Ω–µ–ø–∞—Ä–Ω–∏ –±—Ä–æ—ò–µ–≤–∏ –∏–∑–º–µ—í—É 1 –∏ 10?";
}

if(variant===2){
correct="131517";
q="–ö–æ—ò–∏ —Å—É –Ω–µ–ø–∞—Ä–Ω–∏ –±—Ä–æ—ò–µ–≤–∏ –∏–∑–º–µ—í—É 11 –∏ 19?";
}
}

questionText=q;

document.getElementById("instruction").innerHTML =
`–ó–∞–¥–∞—Ç–∞–∫ ${testCount+1}/20<br>
<b>${instructionText}</b><br>
<span style="font-size:15px;color:#666">${explanationText}</span>`;

document.getElementById("question").innerText=q;
document.getElementById("answer").value="";
document.getElementById("feedback").innerText="";
}

function normalize(str){
let arr=[];
for(let i=0;i<str.length;i+=2){
arr.push(str.substring(i,i+2));
}
return arr.sort().join("");
}

function checkAnswer(){

let user=document.getElementById("answer").value.trim();
if(user==="") return;

let isCorrect=false;

if(correct.length>2){
isCorrect = normalize(user) === normalize(correct);
}else{
isCorrect = user === correct;
}

if(isCorrect){
testCorrect++;
document.getElementById("feedback").innerText="–ë—Ä–∞–≤–æ! üå∏";
}else{
mistakes.push({
instruction: instructionText,
question: questionText,
user: user,
correct: correct
});
document.getElementById("feedback").innerText="–ù–µ—Ç–∞—á–Ω–æ";
}

testCount++;

setTimeout(()=>{
document.getElementById("feedback").innerText="";
newTask();
},900);
}

function endTest(){

let percent=Math.round((testCorrect/TOTAL_TEST)*100);
let message="";

if(percent>=90) message="–û–¥–ª–∏—á–Ω–æ! üëë";
else if(percent>=70) message="–í—Ä–ª–æ –¥–æ–±—Ä–æ! üåü";
else message="–í–µ–∂–±–∞—ò —ò–æ—à üí™";

let html=`
<h3>–†–µ–∑—É–ª—Ç–∞—Ç —Ç–µ—Å—Ç–∞</h3>
<p>${testCorrect} / 20</p>
<p>${percent}%</p>
<p><b>${message}</b></p>
`;

if(mistakes.length>0){
html+="<h4>–ü–æ–≥—Ä–µ—à–Ω–∏ –∑–∞–¥–∞—Ü–∏:</h4>";
mistakes.forEach(m=>{
html+=`
<div class="mistake">
<b>${m.instruction}</b><br>
–ó–∞–¥–∞—Ç–∞–∫: ${m.question}<br>
–¢–≤–æ—ò –æ–¥–≥–æ–≤–æ—Ä: ${m.user}<br>
–¢–∞—á–Ω–æ —Ä–µ—à–µ—ö–µ: ${m.correct}
</div>
`;
});
}else{
html+="<p>–°–≤–∏ –∑–∞–¥–∞—Ü–∏ —Å—É —Ç–∞—á–Ω–∏! üëë</p>";
}

html+=`<button onclick="startTest()">–ü–æ–Ω–æ–≤–∏ —Ç–µ—Å—Ç</button>`;

document.getElementById("resultBox").style.display="block";
document.getElementById("resultBox").innerHTML=html;
}

if("serviceWorker" in navigator){
navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>
