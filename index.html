<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ü—Ä–∏–Ω—Ü–µ–∑–∏–Ω–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–∫–∞ –∞–≤–∞–Ω—Ç—É—Ä–∞ PRO</title>

<style>
:root{
 --primary:#d946ef;
 --secondary:#f472b6;
 --bg:#fdf2f8;
 --card:#ffffff;
}

body{
 margin:0;
 font-family:-apple-system,BlinkMacSystemFont,sans-serif;
 background:linear-gradient(#fbcfe8,#fdf2f8);
 text-align:center;
}

header{
 background:var(--primary);
 color:white;
 padding:18px;
 font-size:22px;
}

.avatar{
 font-size:60px;
 margin-top:10px;
}

.container{
 padding:20px;
 max-width:520px;
 margin:auto;
}

.card{
 background:var(--card);
 padding:20px;
 border-radius:25px;
 box-shadow:0 10px 25px rgba(0,0,0,0.1);
 margin-bottom:20px;
}

button{
 padding:14px;
 margin:6px;
 font-size:15px;
 border-radius:20px;
 border:none;
 background:var(--primary);
 color:white;
 min-width:140px;
}

button.secondary{
 background:var(--secondary);
}

input{
 padding:12px;
 font-size:18px;
 width:180px;
 border-radius:15px;
 border:2px solid #f9a8d4;
 text-align:center;
}

#zadatak{
 font-size:18px;
 margin:15px 0;
}

#poruka{
 font-size:16px;
 font-weight:bold;
 margin-top:10px;
 min-height:40px;
}

.hidden{display:none;}

.sparkle{
 position:absolute;
 font-size:22px;
 animation:float 1s ease-out forwards;
}

@keyframes float{
 from{transform:translateY(0);opacity:1;}
 to{transform:translateY(-60px);opacity:0;}
}
</style>
</head>

<body>

<header>üëë –ü—Ä–∏–Ω—Ü–µ–∑–∏–Ω–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–∫–∞ –∞–≤–∞–Ω—Ç—É—Ä–∞ PRO ‚ú®</header>
<div class="avatar">üë∏üè∞‚ú®</div>

<div class="container">

<div class="card">
 <button onclick="startGame('sab')">–°–∞–±–∏—Ä–∞—ö–µ</button>
 <button onclick="startGame('oduz')">–û–¥—É–∑–∏–º–∞—ö–µ</button>
 <button onclick="startGame('par')">–ü–∞—Ä–Ω–∏ / –ù–µ–ø–∞—Ä–Ω–∏</button>
 <button onclick="startGame('sled')">–ü—Ä–µ—Ç—Ö–æ–¥–Ω–∏–∫ / –°–ª–µ–¥–±–µ–Ω–∏–∫</button>
 <button onclick="startGame('niz')">–ù–∏–∑–æ–≤–∏</button>
 <button onclick="startTest()" class="secondary">üëë –í–µ–ª–∏–∫–∏ —Ç–µ—Å—Ç (20)</button>
</div>

<div class="card">
 <div id="zadatak">–ò–∑–∞–±–µ—Ä–∏ –∏–≥—Ä—É</div>
 <input id="odgovor" onkeyup="autoCheck(event)">
 <div id="poruka"></div>
</div>

<div class="card hidden" id="resultCard">
 <h3>üëë –†–µ–∑—É–ª—Ç–∞—Ç üëë</h3>
 <div id="resultText"></div>
 <button onclick="location.reload()">–ü–æ—á–µ—Ç–∞–∫</button>
</div>

</div>

<script>
let game="";
let correctAnswer;
let explanation="";
let correct=0;
let wrong=0;
let count=0;
let limit=5;

function rand(max){return Math.floor(Math.random()*max)+1;}

function startGame(g){
 game=g;
 limit=5;
 reset();
 nextQuestion();
}

function startTest(){
 game="test";
 limit=20;
 reset();
 nextQuestion();
}

function reset(){
 correct=0;
 wrong=0;
 count=0;
 document.getElementById("resultCard").classList.add("hidden");
}

function randomGame(){
 let arr=["sab","oduz","par","sled","niz"];
 return arr[Math.floor(Math.random()*arr.length)];
}

function nextQuestion(){
 if(count>=limit){
  finish();
  return;
 }

 document.getElementById("odgovor").value="";
 document.getElementById("poruka").innerHTML="";

 let active=(game==="test")?randomGame():game;
 let text=(count+1)+". ";
 let max=20;

 // SABIRANJE
 if(active==="sab"){
  let a=rand(15)+4;
  let b=rand(20-a);
  correctAnswer=a+b;
  explanation=a+" + "+b+" = "+correctAnswer;

  if(Math.random()<0.5){
   text+="–ò–∑—Ä–∞—á—É–Ω–∞—ò: "+a+" + "+b;
  }else{
   text+="–ü—Ä–∏–Ω—Ü–µ–∑–∞ –∏–º–∞ "+a+" –∫—Ä—É–Ω–∞. –î–æ–±–∏–ª–∞ —ò–µ —ò–æ—à "+b+
   ". –ö–æ–ª–∏–∫–æ –∫—Ä—É–Ω–∞ –∏–º–∞ —Å–∞–¥–∞?";
  }
 }

 // ODUZIMANJE
 if(active==="oduz"){
  let a=rand(15)+5;
  let b=rand(a-1)+1;
  correctAnswer=a-b;
  explanation=a+" - "+b+" = "+correctAnswer;

  if(Math.random()<0.5){
   text+="–ò–∑—Ä–∞—á—É–Ω–∞—ò: "+a+" - "+b;
  }else{
   text+="–ü—Ä–∏–Ω—Ü–µ–∑–∞ —ò–µ –∏–º–∞–ª–∞ "+a+" —Ü–≤–µ—Ç–æ–≤–∞. –ü–æ–∫–ª–æ–Ω–∏–ª–∞ —ò–µ "+b+
   ". –ö–æ–ª–∏–∫–æ —ò–æ—ò —ò–µ –æ—Å—Ç–∞–ª–æ?";
  }
 }

 // PAR / NEPAR
 if(active==="par"){
  let niz=[];
  text+="–ù–∞–ø–∏—à–∏ —Å–≤–µ –ø–∞—Ä–Ω–µ –±—Ä–æ—ò–µ–≤–µ –ø—Ä–≤–µ –¥–µ—Å–µ—Ç–∏—Ü–µ.";
  for(let i=2;i<=10;i+=2){niz.push(i);}
  correctAnswer=niz;
  explanation="–ü–∞—Ä–Ω–∏ –±—Ä–æ—ò–µ–≤–∏ —Å–µ –¥–µ–ª–µ —Å–∞ 2. –¢–æ —Å—É: "+niz.join(" ");
 }

 // SLED
 if(active==="sled"){
  let n=rand(18)+1;
  if(Math.random()<0.5){
   correctAnswer=n-1;
   explanation="–ë—Ä–æ—ò –∫–æ—ò–∏ –¥–æ–ª–∞–∑–∏ –ø—Ä–µ "+n+" —ò–µ "+correctAnswer;
   text+="–ö–æ—ò–∏ –±—Ä–æ—ò –¥–æ–ª–∞–∑–∏ –ø—Ä–µ "+n+"?";
  }else{
   correctAnswer=n+1;
   explanation="–ë—Ä–æ—ò –∫–æ—ò–∏ –¥–æ–ª–∞–∑–∏ –ø–æ—Å–ª–µ "+n+" —ò–µ "+correctAnswer;
   text+="–ö–æ—ò–∏ –±—Ä–æ—ò –¥–æ–ª–∞–∑–∏ –ø–æ—Å–ª–µ "+n+"?";
  }
 }

 // NIZ
 if(active==="niz"){
  let start=rand(8)+2;
  let step=[2,3][Math.floor(Math.random()*2)];
  correctAnswer=start+step*3;
  explanation="–ë—Ä–æ—ò–µ–≤–∏ —Ä–∞—Å—Ç—É –∑–∞ "+step+
  ". –°–ª–µ–¥–µ—õ–∏ –±—Ä–æ—ò —ò–µ "+correctAnswer;
  text+="–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: "+start+", "+(start+step)+", "+(start+2*step)+", ?";
 }

 document.getElementById("zadatak").innerHTML=text;
}

function autoCheck(e){
 if(e.key==="Enter"){
  checkAnswer();
 }
}

function checkAnswer(){
 let raw=document.getElementById("odgovor").value.trim();

 if(Array.isArray(correctAnswer)){
   let userArray=raw.replace(/,/g," ")
   .split(" ")
   .filter(x=>x!=="")
   .map(x=>parseInt(x));

   let tacno=true;

   if(userArray.length!==correctAnswer.length){
     tacno=false;
   }else{
     for(let i=0;i<correctAnswer.length;i++){
       if(userArray[i]!==correctAnswer[i]){
         tacno=false;
         break;
       }
     }
   }

   if(tacno){
     correct++;
     showMessage(true);
   }else{
     wrong++;
     showMessage(false);
   }

 }else{
   let input=parseInt(raw);

   if(input===correctAnswer){
     correct++;
     showMessage(true);
   }else{
     wrong++;
     showMessage(false);
   }
 }

 count++;
 setTimeout(nextQuestion,2000);
}

function showMessage(ok){
 let msg=document.getElementById("poruka");

 if(ok){
  msg.style.color="green";
  msg.innerHTML=["–ë—Ä–∞–≤–æ –ø—Ä–∏–Ω—Ü–µ–∑–æ! üëë","–û–¥–ª–∏—á–Ω–æ! ‚ú®","–°—ò–∞—ò–Ω–æ! üå∏"]
  [Math.floor(Math.random()*3)];
  sparkle();
 }else{
  msg.style.color="red";

  if(Array.isArray(correctAnswer)){
   msg.innerHTML="–ù–µ—Ç–∞—á–Ω–æ ‚ùå<br>–¢–∞—á–∞–Ω –æ–¥–≥–æ–≤–æ—Ä —ò–µ: "+
   correctAnswer.join(" ")+"<br>"+explanation;
  }else{
   msg.innerHTML="–ù–µ—Ç–∞—á–Ω–æ ‚ùå<br>–¢–∞—á–∞–Ω –æ–¥–≥–æ–≤–æ—Ä —ò–µ: "+
   correctAnswer+"<br>"+explanation;
  }
 }
}

function sparkle(){
 for(let i=0;i<6;i++){
  let s=document.createElement("div");
  s.className="sparkle";
  s.innerHTML="‚ú®";
  s.style.left=Math.random()*90+"%";
  s.style.top="50%";
  document.body.appendChild(s);
  setTimeout(()=>s.remove(),1000);
 }
}

function finish(){
 document.getElementById("resultCard").classList.remove("hidden");
 let percent=Math.round((correct/limit)*100);
 document.getElementById("resultText").innerHTML=
 "–¢–∞—á–Ω–∏: "+correct+
 "<br>–ü–æ–≥—Ä–µ—à–Ω–∏: "+wrong+
 "<br>–£—Å–ø–µ—à–Ω–æ—Å—Ç: "+percent+"%";
}
</script>

</body>
</html>
