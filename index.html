<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ú–∞—Ç–µ–º–∞—Ç–∏—á–∫–∞ –∞–≤–∞–Ω—Ç—É—Ä–∞</title>
<link rel="manifest" href="manifest.json">

<style>
:root{
 --primary:#2563eb;
 --accent:#f59e0b;
 --bg:#f1f5f9;
 --card:#ffffff;
}

body{
 margin:0;
 font-family:-apple-system,BlinkMacSystemFont,sans-serif;
 background:var(--bg);
 text-align:center;
}

header{
 background:var(--primary);
 color:white;
 padding:15px;
 font-size:20px;
}

.container{
 padding:20px;
 max-width:500px;
 margin:auto;
}

.card{
 background:var(--card);
 padding:20px;
 border-radius:20px;
 box-shadow:0 8px 20px rgba(0,0,0,0.08);
 margin-bottom:20px;
}

button{
 padding:14px;
 margin:6px;
 font-size:16px;
 border-radius:14px;
 border:none;
 background:var(--primary);
 color:white;
 min-width:120px;
}

button.secondary{
 background:var(--accent);
}

input{
 padding:12px;
 font-size:18px;
 width:150px;
 border-radius:12px;
 border:1px solid #ccc;
 text-align:center;
}

#zadatak{
 font-size:24px;
 margin:15px 0;
}

#poruka{
 font-size:18px;
 font-weight:600;
 margin-top:10px;
}

.status{
 font-size:14px;
 margin-top:10px;
 color:#555;
}

.hidden{
 display:none;
}
</style>
</head>

<body>

<header>–ú–∞—Ç–µ–º–∞—Ç–∏—á–∫–∞ –∞–≤–∞–Ω—Ç—É—Ä–∞ üöÄ</header>

<div class="container">

<div class="card">
 <input id="ime" placeholder="–£–Ω–µ—Å–∏ –∏–º–µ">
 <button onclick="sacuvajIme()">–°–∞—á—É–≤–∞—ò</button>
 <div id="pozdrav"></div>
</div>

<div class="card">
 <button onclick="izaberi('sab')">–°–∞–±–∏—Ä–∞—ö–µ</button>
 <button onclick="izaberi('oduz')">–û–¥—É–∑–∏–º–∞—ö–µ</button>
 <button onclick="izaberi('par')">–ü–∞—Ä–Ω–∏/–ù–µ–ø–∞—Ä–Ω–∏</button>
 <button onclick="izaberi('sled')">–ü—Ä–µ—Ç—Ö–æ–¥–Ω–∏–∫/–°–ª–µ–¥–±–µ–Ω–∏–∫</button>
</div>

<div class="card">
 <div id="zadatak">–ò–∑–∞–±–µ—Ä–∏ –æ–±–ª–∞—Å—Ç –¥–∞ –ø–æ—á–Ω–µ—à</div>
 <input id="odgovor">
 <br><br>
 <button class="secondary" onclick="proveri()">–ü—Ä–æ–≤–µ—Ä–∏</button>
 <div id="poruka"></div>
 <div class="status" id="status"></div>
</div>

<div class="card hidden" id="rezultatKartica">
 <h3>–†–µ–∑—É–ª—Ç–∞—Ç –Ω–∏–≤–æ–∞</h3>
 <div id="rezultatTekst"></div>
 <button onclick="sledeciNivo()">–°–ª–µ–¥–µ—õ–∏ –Ω–∏–≤–æ</button>
</div>

</div>

<script>
if ('serviceWorker' in navigator) {
 navigator.serviceWorker.register('sw.js');
}

let oblast="";
let tacno;
let level=1;
let maxLevel=10;
let tacni=0;
let pogresni=0;
let ukupno=0;
let vreme=0;
let timer;

function rand(max){return Math.floor(Math.random()*max)+1;}

function sacuvajIme(){
 let ime=document.getElementById("ime").value;
 localStorage.setItem("ime",ime);
 document.getElementById("pozdrav").innerHTML="–ó–¥—Ä–∞–≤–æ, "+ime+"!";
}

window.onload=function(){
 if(localStorage.getItem("ime")){
  document.getElementById("pozdrav").innerHTML="–ó–¥—Ä–∞–≤–æ, "+localStorage.getItem("ime")+"!";
 }
 updateStatus();
}

function izaberi(o){
 oblast=o;
 resetujNivo();
 novi();
}

function opseg(){
 return 5 + level*2; 
}

function novi(){
 if(ukupno>=5){
  zavrsiNivo();
  return;
 }

 clearInterval(timer);
 vreme=20;
 let max=opseg();
 document.getElementById("poruka").innerHTML="";
 document.getElementById("odgovor").value="";

 if(oblast==="sab"){
  let a=rand(max);
  let b=rand(max-a);
  tacno=a+b;
  document.getElementById("zadatak").innerHTML="–ò–∑—Ä–∞—á—É–Ω–∞—ò: "+a+" + "+b;
 }

 if(oblast==="oduz"){
  let a=rand(max);
  let b=rand(a);
  tacno=a-b;
  document.getElementById("zadatak").innerHTML="–ò–∑—Ä–∞—á—É–Ω–∞—ò: "+a+" - "+b;
 }

 if(oblast==="par"){
  let br=rand(max);
  tacno=(br%2==0)?"–ø–∞—Ä–∞–Ω":"–Ω–µ–ø–∞—Ä–∞–Ω";
  document.getElementById("zadatak").innerHTML="–î–∞ –ª–∏ —ò–µ "+br+" –ø–∞—Ä–∞–Ω –∏–ª–∏ –Ω–µ–ø–∞—Ä–∞–Ω?";
 }

 if(oblast==="sled"){
  let br=rand(max-1);
  if(Math.random()<0.5){
   tacno=br-1;
   document.getElementById("zadatak").innerHTML="–ü—Ä–µ—Ç—Ö–æ–¥–Ω–∏–∫ –±—Ä–æ—ò–∞ "+br+" —ò–µ?";
  }else{
   tacno=br+1;
   document.getElementById("zadatak").innerHTML="–°–ª–µ–¥–±–µ–Ω–∏–∫ –±—Ä–æ—ò–∞ "+br+" —ò–µ?";
  }
 }

 timer=setInterval(function(){
  vreme--;
  updateStatus();
  if(vreme<=0){
   pogresni++;
   ukupno++;
   clearInterval(timer);
   setTimeout(novi,1000);
  }
 },1000);

 updateStatus();
}

function proveri(){
 let unos=document.getElementById("odgovor").value.trim().toLowerCase();
 if(unos==tacno){
  tacni++;
 }else{
  pogresni++;
 }
 ukupno++;
 updateStatus();
 setTimeout(novi,1000);
}

function updateStatus(){
 document.getElementById("status").innerHTML=
 "–ù–∏–≤–æ: "+level+
 " | –¢–∞—á–Ω–∏: "+tacni+
 " | –ü–æ–≥—Ä–µ—à–Ω–∏: "+pogresni+
 " | –í—Ä–µ–º–µ: "+vreme+"s";
}

function zavrsiNivo(){
 document.getElementById("rezultatKartica").classList.remove("hidden");
 document.getElementById("rezultatTekst").innerHTML=
 "–¢–∞—á–Ω–∏ –æ–¥–≥–æ–≤–æ—Ä–∏: "+tacni+
 "<br>–ü–æ–≥—Ä–µ—à–Ω–∏ –æ–¥–≥–æ–≤–æ—Ä–∏: "+pogresni;
}

function sledeciNivo(){
 if(level<maxLevel){
  level++;
 }
 resetujNivo();
 document.getElementById("rezultatKartica").classList.add("hidden");
 novi();
}

function resetujNivo(){
 tacni=0;
 pogresni=0;
 ukupno=0;
}
</script>

</body>
</html>
