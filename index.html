<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üëë –ü—Ä–∏–Ω—Ü–µ–∑–∞ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ üíó</title>

<style>
body{
 margin:0;
 font-family:'Comic Sans MS', cursive, sans-serif;
 background:linear-gradient(to bottom,#ffe4f1,#ffc1d6);
 text-align:center;
}

header{
 background:#e11d48;
 color:white;
 padding:20px;
 font-size:24px;
}

.container{
 max-width:900px;
 margin:30px auto;
 padding:20px;
}

.card{
 background:white;
 padding:25px;
 border-radius:20px;
 box-shadow:0 10px 25px rgba(0,0,0,0.15);
 margin-bottom:20px;
}

.equation{
 font-size:22px;
 font-weight:bold;
 margin:15px 0;
 color:#be123c;
}

input{
 padding:10px;
 font-size:18px;
 font-weight:bold;
 text-align:center;
 border:2px solid #e11d48;
 border-radius:8px;
 margin:5px;
 width:280px;
}

button{
 padding:12px 18px;
 font-size:16px;
 border:none;
 border-radius:12px;
 background:#e11d48;
 color:white;
 margin-top:10px;
 cursor:pointer;
}

#poruka{
 font-weight:bold;
 margin-top:15px;
 color:#be123c;
 font-size:18px;
}

/* üíñ –°—Ä—Ü–∞ */
.heart{
 position:fixed;
 font-size:28px;
 animation:floatUp 1.5s ease-out forwards;
 pointer-events:none;
}
@keyframes floatUp{
 0%{transform:translateY(0);opacity:1;}
 100%{transform:translateY(-150px);opacity:0;}
}

/* üéâ –ö–æ–Ω—Ñ–µ—Ç–µ */
.confetti{
 position:fixed;
 width:10px;
 height:10px;
 animation:fall 2.5s linear forwards;
 pointer-events:none;
}
@keyframes fall{
 0%{transform:translateY(-20px) rotate(0deg);opacity:1;}
 100%{transform:translateY(100vh) rotate(720deg);opacity:0;}
}
</style>
</head>

<body>

<header>üëë –ü—Ä–∏–Ω—Ü–µ–∑–∞ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ üíó</header>

<div class="container">

<div class="card">
 <input id="ime" placeholder="–ò–º–µ –ø—Ä–∏–Ω—Ü–µ–∑–µ">
 <button onclick="startGame()">–ó–∞–ø–æ—á–Ω–∏ –∫–≤–∏–∑</button>
</div>

<div class="card">
 <div id="info"></div>
 <div id="zadatak" class="equation"></div>
 <div id="odgovorPolje"></div>
 <div id="poruka"></div>
</div>

<div class="card" id="rezultatCard" style="display:none;"></div>

</div>

<script>

let –∏–º–µ="";
let question=0;
let limit=22;
let –±–æ–¥–æ–≤–∏=0;
let locked=false;
let usedSequences=new Set();

let correctAnswer=null;
let correctArray=null;
let correctFullExpression=null;

function rand(min,max){
 return Math.floor(Math.random()*(max-min+1))+min;
}

function startGame(){
 –∏–º–µ=document.getElementById("ime").value||"–ü—Ä–∏–Ω—Ü–µ–∑–∞";
 question=0;
 –±–æ–¥–æ–≤–∏=0;
 locked=false;
 usedSequences.clear();
 document.getElementById("rezultatCard").style.display="none";
 nextQuestion();
}

function updateInfo(){
 document.getElementById("info").innerHTML=
 "–ü–∏—Ç–∞—ö–µ: "+(question+1)+" / "+limit+
 " | –ë–æ–¥–æ–≤–∏: "+–±–æ–¥–æ–≤–∏+" üíó";
}

function nextQuestion(){

 if(question>=limit){ finish(); return; }

 locked=false;
 document.getElementById("poruka").innerHTML="";
 document.getElementById("odgovorPolje").innerHTML="";
 correctAnswer=null;
 correctArray=null;
 correctFullExpression=null;

 let tip=rand(1,9);
 let —Ç–µ–∫—Å—Ç=(question+1)+". ";

 if(tip===1){
  let a=rand(12,19), b=rand(1,20-a);
  correctAnswer=a+b;
  —Ç–µ–∫—Å—Ç+="–ò–∑—Ä–∞—á—É–Ω–∞—ò: "+a+" + "+b+" = _";
 }

 if(tip===2){
  let a=rand(15,20), b=rand(5,a-1);
  correctAnswer=a-b;
  tekst+="–ò–∑—Ä–∞—á—É–Ω–∞—ò: "+a+" ‚àí "+b+" = _";
 }

 if(tip===3){
  let a=rand(10,18), b=rand(1,20-a);
  correctAnswer=a+b;
  correctFullExpression=a+"+"+b+"="+(a+b);
  —Ç–µ–∫—Å—Ç+="–ü—Ä–∏–Ω—Ü–µ–∑–∞ –∏–º–∞ "+a+" –∫—Ä—É–Ω–∞ –∏ –¥–æ–±–∏–ª–∞ —ò–µ "+b+
  ". –ù–∞–ø–∏—à–∏ –∫–æ–º–ø–ª–µ—Ç–Ω–æ —Ä–µ—à–µ—ö–µ.";
 }

 if(tip===4){
  correctAnswer=10;
  —Ç–µ–∫—Å—Ç+="–ö–æ—ò–∏ —ò–µ –Ω–∞—ò–≤–µ—õ–∏ –ø–∞—Ä–Ω–∏ –±—Ä–æ—ò –ø—Ä–≤–µ –¥–µ—Å–µ—Ç–∏—Ü–µ?";
 }

 if(tip===5){
  correctAnswer=19;
  —Ç–µ–∫—Å—Ç+="–ö–æ—ò–∏ —ò–µ –Ω–∞—ò–≤–µ—õ–∏ –Ω–µ–ø–∞—Ä–Ω–∏ –±—Ä–æ—ò –¥—Ä—É–≥–µ –¥–µ—Å–µ—Ç–∏—Ü–µ?";
 }

 if(tip===6){
  correctArray=[8,10,12,14,16,18];
  —Ç–µ–∫—Å—Ç+="–ù–∞–ø–∏—à–∏ —Å–≤–µ –ø–∞—Ä–Ω–µ –±—Ä–æ—ò–µ–≤–µ –≤–µ—õ–µ –æ–¥ 6 –∞ –º–∞—ö–µ –æ–¥ 20.";
 }

 if(tip===7){
  correctArray=[12,14,16];
  —Ç–µ–∫—Å—Ç+="–ù–∞–ø–∏—à–∏ —Å–≤–µ –ø–∞—Ä–Ω–µ –±—Ä–æ—ò–µ–≤–µ –∏–∑–º–µ—í—É 10 –∏ 18 (–±–µ–∑ 10 –∏ 18).";
 }

 if(tip===8){

  let nizovi=[
   {p:"–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: 2, 4, 6, _", r:8},
   {p:"–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: 4, 8, 12, _", r:16},
   {p:"–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: 6, 10, 14, _", r:18},
   {p:"–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: 8, 12, 16, _", r:20},
   {p:"–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: 20, 18, 16, _", r:14},
   {p:"–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: 18, 14, 10, _", r:6},
   {p:"–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: 1, 3, 5, _", r:7},
   {p:"–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: 3, 7, 11, _", r:15},
   {p:"–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: 5, 9, 13, _", r:17},
   {p:"–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: 9, 11, 13, _", r:15},
   {p:"–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: 19, 17, 15, _", r:13},
   {p:"–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: 17, 13, 9, _", r:5},
   {p:"–ù–∞—Å—Ç–∞–≤–∏ –Ω–∏–∑: 7, 11, 15, _", r:19}
  ];

  let izbor;
  do{
   izbor=nizovi[rand(0,nizovi.length-1)];
  }while(usedSequences.has(izbor.p));

  usedSequences.add(izbor.p);

  correctAnswer=izbor.r;
  —Ç–µ–∫—Å—Ç+=izbor.p;
 }

 if(tip===9){
  let a=rand(12,20), b=rand(12,20);
  if(a>b) correctAnswer=">";
  if(a<b) correctAnswer="<";
  if(a===b) correctAnswer="=";
  —Ç–µ–∫—Å—Ç+="–£–ø–æ—Ä–µ–¥–∏ –±—Ä–æ—ò–µ–≤–µ: "+a+" _ "+b+
  " (—É–ø–∏—à–∏ <, > –∏–ª–∏ =)";
 }

 document.getElementById("zadatak").innerHTML=—Ç–µ–∫—Å—Ç;
 document.getElementById("odgovorPolje").innerHTML="<input id='odg' autofocus>";

 document.getElementById("odg").addEventListener("keydown",function(e){
   if(e.key==="Enter" && !locked){
     checkAnswer();
   }
 });

 updateInfo();
}

function checkAnswer(){

 if(locked) return;
 locked=true;

 let input=document.getElementById("odg").value.replace(/\s/g,"");
 let tacno=false;

 if(correctAnswer!==null && correctArray===null && correctFullExpression===null){
  if(input==correctAnswer) tacno=true;
 }

 if(correctFullExpression!==null){
  if(input===correctFullExpression) tacno=true;
 }

 if(correctArray!==null){
  let niz=input.split(",").map(x=>parseInt(x));
  tacno=JSON.stringify(niz)===JSON.stringify(correctArray);
 }

 if(tacno){
  –±–æ–¥–æ–≤–∏+=2;
  document.getElementById("poruka").innerHTML="–ë—Ä–∞–≤–æ –ø—Ä–∏–Ω—Ü–µ–∑–æ! üíñ";
  heartAnimation();
 }else{
  document.getElementById("poruka").innerHTML="–ù–µ—Ç–∞—á–Ω–æ ‚ùå";
 }

 question++;
 setTimeout(nextQuestion,1200);
}

function finish(){
 let max=limit*2;
 let proc=Math.round((–±–æ–¥–æ–≤–∏/max)*100);

 let ocena=1;
 if(proc>=90) ocena=5;
 else if(proc>=75) ocena=4;
 else if(proc>=60) ocena=3;
 else if(proc>=50) ocena=2;

 document.getElementById("rezultatCard").style.display="block";
 document.getElementById("rezultatCard").innerHTML=
 "<h3>–†–µ–∑—É–ª—Ç–∞—Ç üíó</h3>"+
 "–ü—Ä–∏–Ω—Ü–µ–∑–∞: <b>"+–∏–º–µ+"</b><br>"+
 "–ë–æ–¥–æ–≤–∏: "+–±–æ–¥–æ–≤–∏+" / "+max+"<br>"+
 "–£—Å–ø–µ—à–Ω–æ—Å—Ç: "+proc+"%<br>"+
 "<b>–û—Ü–µ–Ω–∞: "+ocena+"</b>";

 if(proc===100) confettiEffect();
}

function heartAnimation(){
 for(let i=0;i<6;i++){
  let h=document.createElement("div");
  h.className="heart";
  h.innerHTML=["üíñ","üíó","üíï","üíò"][Math.floor(Math.random()*4)];
  h.style.left=Math.random()*90+"%";
  h.style.top="60%";
  document.body.appendChild(h);
  setTimeout(()=>h.remove(),1500);
 }
}

function confettiEffect(){
 for(let i=0;i<60;i++){
  let c=document.createElement("div");
  c.className="confetti";
  c.style.left=Math.random()*100+"%";
  c.style.background=["#ff4d6d","#ff85a2","#f72585","#d00000"]
   [Math.floor(Math.random()*4)];
  document.body.appendChild(c);
  setTimeout(()=>c.remove(),2500);
 }
}

</script>

</body>
</html>
